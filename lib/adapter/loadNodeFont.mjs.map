{"version":3,"file":"loadNodeFont.mjs","sources":["../../src/adapter/loadNodeFont.ts"],"sourcesContent":["import canvasModule from 'canvas';\r\nimport { getFontFamilyName } from '@pixi/assets';\r\nimport { extensions, ExtensionType, utils } from '@pixi/core';\r\n\r\nimport type { LoaderParser, LoadFontData, ResolvedAsset } from '@pixi/assets';\r\n\r\nconst { registerFont } = canvasModule;\r\nconst validWeights = [\r\n    'normal', 'bold', '100', '200', '300', '400', '500', '600', '700', '800', '900',\r\n];\r\nconst validFonts = ['.woff', '.woff2', '.ttf', '.otf'];\r\n\r\n/** loads a font from a file */\r\nexport const loadNodeFont = {\r\n    extension: ExtensionType.LoadParser,\r\n\r\n    test(url: string): boolean\r\n    {\r\n        return validFonts.includes(utils.path.extname(url).toLowerCase());\r\n    },\r\n\r\n    async load(url: string, options: ResolvedAsset<LoadFontData>): Promise<void>\r\n    {\r\n        const name = options.data?.family ?? getFontFamilyName(url);\r\n        const weights = options.data?.weights?.filter((weight) => validWeights.includes(weight)) ?? ['normal'];\r\n        const data = options.data ?? {} as LoadFontData;\r\n\r\n        for (let i = 0; i < weights.length; i++)\r\n        {\r\n            const weight = weights[i];\r\n\r\n            registerFont(url, {\r\n                ...data,\r\n                family: options.data?.family ?? name,\r\n                weight,\r\n            });\r\n        }\r\n    },\r\n} as LoaderParser;\r\n\r\nextensions.add(loadNodeFont);\r\n"],"names":[],"mappings":";;;;AAMA,MAAM,EAAE,cAAiB,GAAA,YAAA,CAAA;AACzB,MAAM,YAAe,GAAA;AAAA,EACjB,QAAA;AAAA,EAAU,MAAA;AAAA,EAAQ,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAC9E,CAAA,CAAA;AACA,MAAM,UAAa,GAAA,CAAC,OAAS,EAAA,QAAA,EAAU,QAAQ,MAAM,CAAA,CAAA;AAG9C,MAAM,YAAe,GAAA;AAAA,EACxB,WAAW,aAAc,CAAA,UAAA;AAAA,EAEzB,KAAK,GACL,EAAA;AACI,IAAO,OAAA,UAAA,CAAW,SAAS,KAAM,CAAA,IAAA,CAAK,QAAQ,GAAG,CAAA,CAAE,aAAa,CAAA,CAAA;AAAA,GACpE;AAAA,EAEA,MAAM,IAAK,CAAA,GAAA,EAAa,OACxB,EAAA;AACI,IAAA,MAAM,IAAO,GAAA,OAAA,CAAQ,IAAM,EAAA,MAAA,IAAU,kBAAkB,GAAG,CAAA,CAAA;AAC1D,IAAA,MAAM,OAAU,GAAA,OAAA,CAAQ,IAAM,EAAA,OAAA,EAAS,MAAO,CAAA,CAAC,MAAW,KAAA,YAAA,CAAa,QAAS,CAAA,MAAM,CAAC,CAAA,IAAK,CAAC,QAAQ,CAAA,CAAA;AACrG,IAAM,MAAA,IAAA,GAAO,OAAQ,CAAA,IAAA,IAAQ,EAAC,CAAA;AAE9B,IAAA,KAAA,IAAS,CAAI,GAAA,CAAA,EAAG,CAAI,GAAA,OAAA,CAAQ,QAAQ,CACpC,EAAA,EAAA;AACI,MAAM,MAAA,MAAA,GAAS,QAAQ,CAAC,CAAA,CAAA;AAExB,MAAA,YAAA,CAAa,GAAK,EAAA;AAAA,QACd,GAAG,IAAA;AAAA,QACH,MAAA,EAAQ,OAAQ,CAAA,IAAA,EAAM,MAAU,IAAA,IAAA;AAAA,QAChC,MAAA;AAAA,OACH,CAAA,CAAA;AAAA,KACL;AAAA,GACJ;AACJ,EAAA;AAEA,UAAA,CAAW,IAAI,YAAY,CAAA;;;;"}